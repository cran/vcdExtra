<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Michael Friendly" />

<meta name="date" content="2025-12-10" />

<title>1. Creating and manipulating frequency tables</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">1. Creating and manipulating frequency
tables</h1>
<h4 class="author">Michael Friendly</h4>
<h4 class="date">2025-12-10</h4>



<p>R provides many methods for creating frequency and contingency
tables. Several are described below. In the examples below, we use some
real examples and some anonymous ones, where the variables
<code>A</code>, <code>B</code>, and <code>C</code> represent categorical
variables, and <code>X</code> represents an arbitrary R data object.</p>
<div id="forms-of-frequency-data" class="section level2">
<h2>Forms of frequency data</h2>
<p>The first thing you need to know is that categorical data can be
represented in three different forms in R, and it is sometimes necessary
to convert from one form to another, for carrying out statistical tests,
fitting models or visualizing the results. Once a data object exists in
R, you can examine its complete structure with the <code>str()</code>
function, or view the names of its components with the
<code>names()</code> function.</p>
<div id="case-form" class="section level3">
<h3>Case form</h3>
<p>Categorical data in case form are simply data frames containing
individual observations, with one or more factors, used as the
classifying variables. In case form, there may also be numeric
covariates. The total number of observations is <code>nrow(X)</code>,
and the number of variables is <code>ncol(X)</code>.</p>
<p><strong><em>Example</em></strong>:</p>
<p>The <code>Arthritis</code> data is available in case form in the
<code>vcd</code> package. There are two explanatory factors:
<code>Treatment</code> and <code>Sex</code>. <code>Age</code> is a
numeric covariate, and <code>Improved</code> is the response— an ordered
factor, with levels None &lt; Some &lt; Marked. Excluding
<code>Age</code>, this represents a <span class="math inline">\(2 \times
2 \times 3\)</span> contingency table for <code>Treatment</code>,
<code>Sex</code> and <code>Improved</code>, but in case form.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">names</span>(Arthritis)      <span class="co"># show the variables</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">## [1] &quot;ID&quot;        &quot;Treatment&quot; &quot;Sex&quot;       &quot;Age&quot;       &quot;Improved&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">str</span>(Arthritis)        <span class="co"># show the structure</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="do">## &#39;data.frame&#39;:    84 obs. of  5 variables:</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="do">##  $ ID       : int  57 46 77 17 36 23 75 39 33 55 ...</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="do">##  $ Treatment: Factor w/ 2 levels &quot;Placebo&quot;,&quot;Treated&quot;: 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="do">##  $ Sex      : Factor w/ 2 levels &quot;Female&quot;,&quot;Male&quot;: 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="do">##  $ Age      : int  27 29 30 32 46 58 59 59 63 63 ...</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="do">##  $ Improved : Ord.factor w/ 3 levels &quot;None&quot;&lt;&quot;Some&quot;&lt;..: 2 1 1 3 3 3 1 3 1 1 ...</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="fu">head</span>(Arthritis,<span class="dv">5</span>)     <span class="co"># first 5 observations, same as Arthritis[1:5,] </span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="do">##   ID Treatment  Sex Age Improved</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="do">## 1 57   Treated Male  27     Some</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="do">## 2 46   Treated Male  29     None</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="do">## 3 77   Treated Male  30     None</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="do">## 4 17   Treated Male  32   Marked</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="do">## 5 36   Treated Male  46   Marked</span></span></code></pre></div>
</div>
<div id="frequency-form" class="section level3">
<h3>Frequency form</h3>
<p>Data in frequency form is also a data frame containing one or more
factors, and a frequency variable, often called <code>Freq</code> or
<code>count</code>. The total number of observations is:
<code>sum(X$Freq)</code>, <code>sum(X[,&quot;Freq&quot;])</code> or some
equivalent form.</p>
<p>The number of cells in the table is given by
<code>nrow(X)</code>.</p>
<p><strong><em>Example</em></strong>: For small frequency tables, it is
often convenient to enter them in frequency form using
<code>expand.grid()</code> for the factors and <code>c()</code> to list
the counts in a vector. The example below, from <span class="citation">(Agresti, 2002)</span> gives results for the 1991
General Social Survey, with respondents classified by sex and party
identification.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Agresti (2002), table 3.11, p. 106</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>GSS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="fu">expand.grid</span>(<span class="at">sex =</span> <span class="fu">c</span>(<span class="st">&quot;female&quot;</span>, <span class="st">&quot;male&quot;</span>), </span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>              <span class="at">party =</span> <span class="fu">c</span>(<span class="st">&quot;dem&quot;</span>, <span class="st">&quot;indep&quot;</span>, <span class="st">&quot;rep&quot;</span>)),</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">count =</span> <span class="fu">c</span>(<span class="dv">279</span>,<span class="dv">165</span>,<span class="dv">73</span>,<span class="dv">47</span>,<span class="dv">225</span>,<span class="dv">191</span>))</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>GSS</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="do">##      sex party count</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="do">## 1 female   dem   279</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="do">## 2   male   dem   165</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="do">## 3 female indep    73</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="do">## 4   male indep    47</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="do">## 5 female   rep   225</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="do">## 6   male   rep   191</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="fu">names</span>(GSS)</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="do">## [1] &quot;sex&quot;   &quot;party&quot; &quot;count&quot;</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="fu">str</span>(GSS)</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="do">## &#39;data.frame&#39;:    6 obs. of  3 variables:</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="do">##  $ sex  : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 1 2 1 2 1 2</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="do">##  $ party: Factor w/ 3 levels &quot;dem&quot;,&quot;indep&quot;,..: 1 1 2 2 3 3</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="do">##  $ count: num  279 165 73 47 225 191</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="fu">sum</span>(GSS<span class="sc">$</span>count)</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="do">## [1] 980</span></span></code></pre></div>
</div>
<div id="table-form" class="section level3">
<h3>Table form</h3>
<p>Table form data is represented by a <code>matrix</code>,
<code>array</code> or <code>table</code> object, whose elements are the
frequencies in an <span class="math inline">\(n\)</span>-way table. The
variable names (factors) and their levels are given by
<code>dimnames(X)</code>. The total number of observations is
<code>sum(X)</code>. The number of dimensions of the table is
<code>length(dimnames(X))</code>, and the table sizes are given by
<code>sapply(dimnames(X), length)</code>.</p>
<p><strong><em>Example</em></strong>: The <code>HairEyeColor</code> is
stored in table form in <code>vcd</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">str</span>(HairEyeColor)                      <span class="co"># show the structure</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="do">##  &#39;table&#39; num [1:4, 1:4, 1:2] 32 53 10 3 11 50 10 30 10 25 ...</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="do">##  - attr(*, &quot;dimnames&quot;)=List of 3</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="do">##   ..$ Hair: chr [1:4] &quot;Black&quot; &quot;Brown&quot; &quot;Red&quot; &quot;Blond&quot;</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="do">##   ..$ Eye : chr [1:4] &quot;Brown&quot; &quot;Blue&quot; &quot;Hazel&quot; &quot;Green&quot;</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="do">##   ..$ Sex : chr [1:2] &quot;Male&quot; &quot;Female&quot;</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="fu">sum</span>(HairEyeColor)                      <span class="co"># number of cases</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="do">## [1] 592</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="fu">sapply</span>(<span class="fu">dimnames</span>(HairEyeColor), length) <span class="co"># table dimension sizes</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="do">## Hair  Eye  Sex </span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="do">##    4    4    2</span></span></code></pre></div>
<p><strong><em>Example</em></strong>: Enter frequencies in a matrix, and
assign <code>dimnames</code>, giving the variable names and category
labels. Note that, by default, <code>matrix()</code> uses the elements
supplied by <em>columns</em> in the result, unless you specify
<code>byrow=TRUE</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># A 4 x 4 table  Agresti (2002, Table 2.8, p. 57) Job Satisfaction</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>JobSat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>, </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                    <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">1</span>, </span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                   <span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">14</span>, <span class="dv">9</span>, </span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>                    <span class="dv">6</span>, <span class="dv">7</span>,<span class="dv">12</span>,<span class="dv">11</span>), <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">dimnames</span>(JobSat) <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="at">income =</span> <span class="fu">c</span>(<span class="st">&quot;&lt; 15k&quot;</span>, <span class="st">&quot;15-25k&quot;</span>, <span class="st">&quot;25-40k&quot;</span>, <span class="st">&quot;&gt; 40k&quot;</span>),</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  <span class="at">satisfaction =</span> <span class="fu">c</span>(<span class="st">&quot;VeryD&quot;</span>, <span class="st">&quot;LittleD&quot;</span>, <span class="st">&quot;ModerateS&quot;</span>, <span class="st">&quot;VeryS&quot;</span>)</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  )</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>JobSat</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="do">##         satisfaction</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="do">## income   VeryD LittleD ModerateS VeryS</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="do">##   &lt; 15k      1       3        10     6</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="do">##   15-25k     2       3        10     7</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="do">##   25-40k     1       6        14    12</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="do">##   &gt; 40k      0       1         9    11</span></span></code></pre></div>
<p><code>JobSat</code> is a <strong>matrix</strong>, not an object of
<code>class(&quot;table&quot;)</code>, and some functions are happier with tables
than matrices. You can coerce it to a table with
<code>as.table()</code>,</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>JobSat <span class="ot">&lt;-</span> <span class="fu">as.table</span>(JobSat)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">str</span>(JobSat)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="do">##  &#39;table&#39; num [1:4, 1:4] 1 2 1 0 3 3 6 1 10 10 ...</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="do">##  - attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="do">##   ..$ income      : chr [1:4] &quot;&lt; 15k&quot; &quot;15-25k&quot; &quot;25-40k&quot; &quot;&gt; 40k&quot;</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="do">##   ..$ satisfaction: chr [1:4] &quot;VeryD&quot; &quot;LittleD&quot; &quot;ModerateS&quot; &quot;VeryS&quot;</span></span></code></pre></div>
</div>
</div>
<div id="sec:ordered-factors" class="section level2">
<h2>Ordered factors and reordered tables</h2>
<p>In table form, the values of the table factors are ordered by their
position in the table. Thus in the <code>JobSat</code> data, both
<code>income</code> and <code>satisfaction</code> represent ordered
factors, and the <em>positions</em> of the values in the rows and
columns reflects their ordered nature.</p>
<p>Yet, for analysis, there are times when you need <em>numeric</em>
values for the levels of ordered factors in a table, e.g., to treat a
factor as a quantitative variable. In such cases, you can simply
re-assign the <code>dimnames</code> attribute of the table variables.
For example, here, we assign numeric values to <code>income</code> as
the middle of their ranges, and treat <code>satisfaction</code> as
equally spaced with integer scores.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">dimnames</span>(JobSat)<span class="sc">$</span>income <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">7.5</span>,<span class="dv">20</span>,<span class="fl">32.5</span>,<span class="dv">60</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">dimnames</span>(JobSat)<span class="sc">$</span>satisfaction <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span></code></pre></div>
<p>For the <code>HairEyeColor</code> data, hair color and eye color are
ordered arbitrarily. For visualizing the data using mosaic plots and
other methods described below, it turns out to be more useful to assure
that both hair color and eye color are ordered from dark to light. Hair
colors are actually ordered this way already, and it is easiest to
re-order eye colors by indexing. Again <code>str()</code> is your
friend.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>HairEyeColor <span class="ot">&lt;-</span> HairEyeColor[, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>), ]</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">str</span>(HairEyeColor)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="do">##  &#39;table&#39; num [1:4, 1:4, 1:2] 32 53 10 3 10 25 7 5 3 15 ...</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="do">##  - attr(*, &quot;dimnames&quot;)=List of 3</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="do">##   ..$ Hair: chr [1:4] &quot;Black&quot; &quot;Brown&quot; &quot;Red&quot; &quot;Blond&quot;</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="do">##   ..$ Eye : chr [1:4] &quot;Brown&quot; &quot;Hazel&quot; &quot;Green&quot; &quot;Blue&quot;</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="do">##   ..$ Sex : chr [1:2] &quot;Male&quot; &quot;Female&quot;</span></span></code></pre></div>
<p>This is also the order for both hair color and eye color shown in the
result of a correspondence analysis (<span class="citation">(<strong>ref?</strong>)</span>(fig:ca-haireye)
below.</p>
<p>With data in case form or frequency form, when you have ordered
factors represented with character values, you must ensure that they are
treated as ordered in R.
<!-- \footnote{In SAS, many procedures offer the option -->
<!--    `order = data | internal | formatted` to allow character values -->
<!--    to be ordered according to (a) their order in the data set, (b) -->
<!--    sorted internal value, or (c) sorted formatted representation -->
<!--    provided by a SAS format. --> <!-- } --></p>
<p>Imagine that the <code>Arthritis</code> data was read from a text
file.<br />
By default the <code>Improved</code> will be ordered alphabetically:
<code>Marked</code>, <code>None</code>, <code>Some</code> — not what we
want. In this case, the function <code>ordered()</code> (and others) can
be useful.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>Arthritis <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;arthritis.txt&quot;</span>,<span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>Arthritis<span class="sc">$</span>Improved <span class="ot">&lt;-</span> <span class="fu">ordered</span>(Arthritis<span class="sc">$</span>Improved, </span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                              <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;None&quot;</span>, <span class="st">&quot;Some&quot;</span>, <span class="st">&quot;Marked&quot;</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                              )</span></code></pre></div>
<p>The dataset <code>Arthritis</code> in the <code>vcd</code> package is
a data.frame in this form With this order of <code>Improved</code>, the
response in this data, a mosaic display of <code>Treatment</code> and
<code>Improved</code> (<span class="citation">(<strong>ref?</strong>)</span>(fig:arthritis) shows a
clearly interpretable pattern.</p>
<p>The original version of <code>mosaic</code> in the <code>vcd</code>
package required the input to be a contingency table in array form, so
we convert using <code>xtabs()</code>.</p>
<!-- ```{r Arthritis, height=6, width=7, fig.cap="Mosaic plot for the `Arthritis` data ..."} -->
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">data</span>(Arthritis, <span class="at">package=</span><span class="st">&quot;vcd&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>art <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="sc">~</span>Treatment <span class="sc">+</span> Improved, <span class="at">data =</span> Arthritis)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">mosaic</span>(art, <span class="at">gp =</span> shading_max, <span class="at">split_vertical =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">&quot;Arthritis: [Treatment] [Improved]&quot;</span>)</span></code></pre></div>
<div class="float">
<img role="img" aria-label="Mosaic plot for the Arthritis data, showing the marginal model of independence for Treatment and Improved. Age, a covariate, and Sex are ignored here." src="data:image/png;base64,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" alt="Mosaic plot for the Arthritis data, showing the marginal model of independence for Treatment and Improved. Age, a covariate, and Sex are ignored here." />
<div class="figcaption">Mosaic plot for the <code>Arthritis</code> data,
showing the marginal model of independence for Treatment and Improved.
Age, a covariate, and Sex are ignored here.</div>
</div>
<p>Several data sets in the package illustrate the salutary effects of
reordering factor levels in mosaic displays and other analyses. See:</p>
<ul>
<li><code>help(AirCrash)</code></li>
<li><code>help(Glass)</code></li>
<li><code>help(HouseTasks)</code></li>
</ul>
<p>The <a href="https://CRAN.R-project.org/package=seriation">seriate</a> package
now contains a general method to permute the row and column variables in
a table according to the result of a correspondence analysis, using
scores on the first CA dimension.</p>
<div id="re-ordering-dimensions" class="section level3">
<h3>Re-ordering dimensions</h3>
<p>Finally, there are situations where, particularly for display
purposes, you want to re-order the <em>dimensions</em> of an <span class="math inline">\(n\)</span>-way table, or change the labels for the
variables or levels. This is easy when the data are in table form:
<code>aperm()</code> permutes the dimensions, and assigning to
<code>names</code> and <code>dimnames</code> changes variable names and
level labels respectively. We will use the following version of
<code>UCBAdmissions</code> in @ref(sec:mantel) below. <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>UCB <span class="ot">&lt;-</span> <span class="fu">aperm</span>(UCBAdmissions, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">dimnames</span>(UCB)[[<span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">dimnames</span>(UCB)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;Admit?&quot;</span>, <span class="st">&quot;Department&quot;</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co"># display as a flattened table</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>stats<span class="sc">::</span><span class="fu">ftable</span>(UCB)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="do">##               Department   A   B   C   D   E   F</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="do">## Sex    Admit?                                   </span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="do">## Male   Yes               512 353 120 138  53  22</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="do">##        No                313 207 205 279 138 351</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="do">## Female Yes                89  17 202 131  94  24</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="do">##        No                 19   8 391 244 299 317</span></span></code></pre></div>
</div>
</div>
<div id="sec:structable" class="section level2">
<h2><code>structable()</code></h2>
<p>For 3-way and larger tables the <code>structable()</code> function in
<code>vcd</code> provides a convenient and flexible tabular display. The
variables assigned to the rows and columns of a two-way display can be
specified by a model formula.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">structable</span>(HairEyeColor)                   <span class="co"># show the table: default</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="do">##              Eye Brown Hazel Green Blue</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="do">## Hair  Sex                              </span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="do">## Black Male          32    10     3   11</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="do">##       Female        36     5     2    9</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="do">## Brown Male          53    25    15   50</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="do">##       Female        66    29    14   34</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="do">## Red   Male          10     7     7   10</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="do">##       Female        16     7     7    7</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="do">## Blond Male           3     5     8   30</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="do">##       Female         4     5     8   64</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="fu">structable</span>(Hair<span class="sc">+</span>Sex <span class="sc">~</span> Eye, HairEyeColor)   <span class="co"># specify col ~ row variables</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="do">##       Hair Black        Brown         Red        Blond       </span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="do">##       Sex   Male Female  Male Female Male Female  Male Female</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="do">## Eye                                                          </span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="do">## Brown         32     36    53     66   10     16     3      4</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="do">## Hazel         10      5    25     29    7      7     5      5</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="do">## Green          3      2    15     14    7      7     8      8</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="do">## Blue          11      9    50     34   10      7    30     64</span></span></code></pre></div>
<p>It also returns an object of class <code>&quot;structable&quot;</code> which
may be plotted with <code>mosaic()</code> (not shown here).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>HSE <span class="sc">&lt;</span> <span class="sc">-</span> <span class="fu">structable</span>(Hair<span class="sc">+</span>Sex <span class="sc">~</span> Eye, HairEyeColor)   <span class="co"># save structable object</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">mosaic</span>(HSE)                                        <span class="co"># plot it</span></span></code></pre></div>
</div>
<div id="sec:table" class="section level2">
<h2><code>table()</code> and friends</h2>
<p>You can generate frequency tables from factor variables using the
<code>table()</code> function, tables of proportions using the
<code>prop.table()</code> function, and marginal frequencies using
<code>margin.table()</code>.</p>
<p>For these examples, create some categorical vectors:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a> n<span class="ot">=</span><span class="dv">500</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a> A <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;a1&quot;</span>,<span class="st">&quot;a2&quot;</span>), n, <span class="at">rep=</span><span class="cn">TRUE</span>))</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a> B <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;b1&quot;</span>,<span class="st">&quot;b2&quot;</span>), n, <span class="at">rep=</span><span class="cn">TRUE</span>))</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a> C <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;c1&quot;</span>,<span class="st">&quot;c2&quot;</span>), n, <span class="at">rep=</span><span class="cn">TRUE</span>))</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a> mydata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(A,B,C)</span></code></pre></div>
<p>These lines illustrate <code>table</code>-related functions:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># 2-Way Frequency Table</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">attach</span>(mydata)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>mytable <span class="ot">&lt;-</span> <span class="fu">table</span>(A,B)   <span class="co"># A will be rows, B will be columns</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>mytable                 <span class="co"># print table</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="do">##     B</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="do">## A     b1  b2</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="do">##   a1 116 114</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="do">##   a2 138 132</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="fu">margin.table</span>(mytable, <span class="dv">1</span>) <span class="co"># A frequencies (summed over B)</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="do">## A</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="do">##  a1  a2 </span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="do">## 230 270</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="fu">margin.table</span>(mytable, <span class="dv">2</span>) <span class="co"># B frequencies (summed over A)</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="do">## B</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="do">##  b1  b2 </span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="do">## 254 246</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="fu">prop.table</span>(mytable)    <span class="co"># cell percentages</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="do">##     B</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="do">## A       b1    b2</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="do">##   a1 0.232 0.228</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="do">##   a2 0.276 0.264</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="fu">prop.table</span>(mytable, <span class="dv">1</span>) <span class="co"># row percentages</span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="do">##     B</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="do">## A           b1        b2</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="do">##   a1 0.5043478 0.4956522</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="do">##   a2 0.5111111 0.4888889</span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="fu">prop.table</span>(mytable, <span class="dv">2</span>) <span class="co"># column percentages</span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="do">##     B</span></span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="do">## A           b1        b2</span></span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a><span class="do">##   a1 0.4566929 0.4634146</span></span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a><span class="do">##   a2 0.5433071 0.5365854</span></span></code></pre></div>
<p><code>table()</code> can also generate multidimensional tables based
on 3 or more categorical variables. In this case, you can use the
<code>ftable()</code> or <code>structable()</code> function to print the
results more attractively.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># 3-Way Frequency Table</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>mytable <span class="ot">&lt;-</span> <span class="fu">table</span>(A, B, C)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">ftable</span>(mytable)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="do">##       C c1 c2</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="do">## A  B         </span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="do">## a1 b1   45 71</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="do">##    b2   59 55</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="do">## a2 b1   62 76</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="do">##    b2   76 56</span></span></code></pre></div>
<p><code>table()</code> ignores missing values by default. To include
<code>NA</code> as a category in counts, include the table option
<code>exclude=NULL</code> if the variable is a vector. If the variable
is a factor you have to create a new factor using .</p>
</div>
<div id="sec:xtabs" class="section level2">
<h2><code>xtabs()</code></h2>
<p>The <code>xtabs()</code> function allows you to create
cross-tabulations of data using formula style input. This typically
works with case-form data supplied in a data frame or a matrix. The
result is a contingency table in array format, whose dimensions are
determined by the terms on the right side of the formula.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># 3-Way Frequency Table</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>mytable <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(<span class="sc">~</span>A<span class="sc">+</span>B<span class="sc">+</span>C, <span class="at">data=</span>mydata)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="fu">ftable</span>(mytable)    <span class="co"># print table</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="do">##       C c1 c2</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="do">## A  B         </span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="do">## a1 b1   45 71</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="do">##    b2   59 55</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="do">## a2 b1   62 76</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="do">##    b2   76 56</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a><span class="fu">summary</span>(mytable)   <span class="co"># chi-square test of indepedence</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="do">## Call: xtabs(formula = ~A + B + C, data = mydata)</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="do">## Number of cases in table: 500 </span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a><span class="do">## Number of factors: 3 </span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="do">## Test for independence of all factors:</span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="do">##  Chisq = 9.888, df = 4, p-value = 0.04235</span></span></code></pre></div>
<p>If a variable is included on the left side of the formula, it is
assumed to be a vector of frequencies (useful if the data have already
been tabulated in frequency form).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>(GSStab <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(count <span class="sc">~</span> sex <span class="sc">+</span> party, <span class="at">data=</span>GSS))</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="do">##         party</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="do">## sex      dem indep rep</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="do">##   female 279    73 225</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="do">##   male   165    47 191</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="fu">summary</span>(GSStab)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="do">## Call: xtabs(formula = count ~ sex + party, data = GSS)</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="do">## Number of cases in table: 980 </span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="do">## Number of factors: 2 </span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="do">## Test for independence of all factors:</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="do">##  Chisq = 7.01, df = 2, p-value = 0.03005</span></span></code></pre></div>
</div>
<div id="collapsing-over-table-factors-aggregate-margin.table-and-apply" class="section level2">
<h2>Collapsing over table factors: <code>aggregate()</code>,
<code>margin.table()</code> and <code>apply()</code></h2>
<p>It sometimes happens that we have a data set with more variables or
factors than we want to analyse, or else, having done some initial
analyses, we decide that certain factors are not important, and so
should be excluded from graphic displays by collapsing (summing) over
them. For example, mosaic plots and fourfold displays are often simpler
to construct from versions of the data collapsed over the factors which
are not shown in the plots.</p>
<p>The appropriate tools to use again depend on the form in which the
data are represented— a case-form data frame, a frequency-form data
frame (<code>aggregate()</code>), or a table-form array or table object
(<code>margin.table()</code> or <code>apply()</code>).</p>
<p>When the data are in frequency form, and we want to produce another
frequency data frame, <code>aggregate()</code> is a handy tool, using
the argument <code>FUN=sum</code> to sum the frequency variable over the
factors <em>not</em> mentioned in the formula.</p>
<p><strong><em>Example</em></strong>: The data frame
<code>DaytonSurvey</code> in the <code>vcdExtra</code> package
represents a <span class="math inline">\(2^5\)</span> table giving the
frequencies of reported use (``ever used?’’) of alcohol, cigarettes and
marijuana in a sample of high school seniors, also classified by sex and
race.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;DaytonSurvey&quot;</span>, <span class="at">package=</span><span class="st">&quot;vcdExtra&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">str</span>(DaytonSurvey)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="do">## &#39;data.frame&#39;:    32 obs. of  6 variables:</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="do">##  $ cigarette: Factor w/ 2 levels &quot;Yes&quot;,&quot;No&quot;: 1 2 1 2 1 2 1 2 1 2 ...</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="do">##  $ alcohol  : Factor w/ 2 levels &quot;Yes&quot;,&quot;No&quot;: 1 1 2 2 1 1 2 2 1 1 ...</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="do">##  $ marijuana: Factor w/ 2 levels &quot;Yes&quot;,&quot;No&quot;: 1 1 1 1 2 2 2 2 1 1 ...</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="do">##  $ sex      : Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 1 1 1 1 1 1 1 1 2 2 ...</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="do">##  $ race     : Factor w/ 2 levels &quot;white&quot;,&quot;other&quot;: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="do">##  $ Freq     : num  405 13 1 1 268 218 17 117 453 28 ...</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="fu">head</span>(DaytonSurvey)</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="do">##   cigarette alcohol marijuana    sex  race Freq</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="do">## 1       Yes     Yes       Yes female white  405</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="do">## 2        No     Yes       Yes female white   13</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="do">## 3       Yes      No       Yes female white    1</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="do">## 4        No      No       Yes female white    1</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="do">## 5       Yes     Yes        No female white  268</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="do">## 6        No     Yes        No female white  218</span></span></code></pre></div>
<p>To focus on the associations among the substances, we want to
collapse over sex and race. The right-hand side of the formula used in
the call to <code>aggregate()</code> gives the factors to be retained in
the new frequency data frame, <code>Dayton.ACM.df</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># data in frequency form</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="co"># collapse over sex and race</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>Dayton.ACM.df <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Freq <span class="sc">~</span> cigarette<span class="sc">+</span>alcohol<span class="sc">+</span>marijuana, </span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>                           <span class="at">data=</span>DaytonSurvey, </span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>                           <span class="at">FUN=</span>sum)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>Dayton.ACM.df</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="do">##   cigarette alcohol marijuana Freq</span></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="do">## 1       Yes     Yes       Yes  911</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="do">## 2        No     Yes       Yes   44</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="do">## 3       Yes      No       Yes    3</span></span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="do">## 4        No      No       Yes    2</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="do">## 5       Yes     Yes        No  538</span></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="do">## 6        No     Yes        No  456</span></span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a><span class="do">## 7       Yes      No        No   43</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a><span class="do">## 8        No      No        No  279</span></span></code></pre></div>
<p>When the data are in table form, and we want to produce another
table, <code>apply()</code> with <code>FUN=sum</code> can be used in a
similar way to sum the table over dimensions not mentioned in the
<code>MARGIN</code> argument. <code>margin.table()</code> is just a
wrapper for <code>apply()</code> using the <code>sum()</code>
function.</p>
<p><strong><em>Example</em></strong>: To illustrate, we first convert
the <code>DaytonSurvey</code> to a 5-way table using
<code>xtabs()</code>, giving <code>Dayton.tab</code>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># in table form</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>Dayton.tab <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(Freq <span class="sc">~</span> cigarette<span class="sc">+</span>alcohol<span class="sc">+</span>marijuana<span class="sc">+</span>sex<span class="sc">+</span>race, </span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>                    <span class="at">data=</span>DaytonSurvey)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="fu">structable</span>(cigarette<span class="sc">+</span>alcohol<span class="sc">+</span>marijuana <span class="sc">~</span> sex<span class="sc">+</span>race, </span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>           <span class="at">data=</span>Dayton.tab)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="do">##              cigarette Yes              No            </span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="do">##              alcohol   Yes      No     Yes      No    </span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="do">##              marijuana Yes  No Yes  No Yes  No Yes  No</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="do">## sex    race                                           </span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="do">## female white           405 268   1  17  13 218   1 117</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="do">##        other            23  23   0   1   2  19   0  12</span></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="do">## male   white           453 228   1  17  28 201   1 133</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a><span class="do">##        other            30  19   1   8   1  18   0  17</span></span></code></pre></div>
<p>Then, use <code>apply()</code> on <code>Dayton.tab</code> to give the
3-way table <code>Dayton.ACM.tab</code> summed over sex and race. The
elements in this new table are the column sums for
<code>Dayton.tab</code> shown by <code>structable()</code> just
above.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># collapse over sex and race</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>Dayton.ACM.tab <span class="ot">&lt;-</span> <span class="fu">apply</span>(Dayton.tab, <span class="at">MARGIN=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">FUN=</span>sum)</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>Dayton.ACM.tab <span class="ot">&lt;-</span> <span class="fu">margin.table</span>(Dayton.tab, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)   <span class="co"># same result</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="fu">structable</span>(cigarette<span class="sc">+</span>alcohol <span class="sc">~</span> marijuana, <span class="at">data=</span>Dayton.ACM.tab)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="do">##           cigarette Yes      No    </span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="do">##           alcohol   Yes  No Yes  No</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="do">## marijuana                          </span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="do">## Yes                 911   3  44   2</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="do">## No                  538  43 456 279</span></span></code></pre></div>
<p>Many of these operations can be performed using the
<code>**ply()</code> functions in the <a href="https://CRAN.R-project.org/package=plyr"><code>plyr</code></a>
package. For example, with the data in a frequency form data frame, use
<code>ddply()</code> to collapse over unmentioned factors, and
<code>plyr::summarise()</code> as the function to be applied to each
piece. <!-- \footnote{ -->
<!-- Ugh. This `plyr` function clashes with a function of the same name in `vcdExtra`. -->
<!-- In this document I will use the explicit double-colon notation to keep them -->
<!-- separate. --> <!-- } --></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>Dayton.ACM.df <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">ddply</span>(DaytonSurvey, </span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>                             .(cigarette, alcohol, marijuana), </span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>                             plyr<span class="sc">::</span>summarise, <span class="at">Freq=</span><span class="fu">sum</span>(Freq))</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>Dayton.ACM.df</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="do">##   cigarette alcohol marijuana Freq</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="do">## 1       Yes     Yes       Yes  911</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="do">## 2       Yes     Yes        No  538</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="do">## 3       Yes      No       Yes    3</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="do">## 4       Yes      No        No   43</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="do">## 5        No     Yes       Yes   44</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="do">## 6        No     Yes        No  456</span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="do">## 7        No      No       Yes    2</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="do">## 8        No      No        No  279</span></span></code></pre></div>
</div>
<div id="collapsing-table-levels-collapse.table" class="section level2">
<h2>Collapsing table levels: <code>collapse.table()</code></h2>
<p>A related problem arises when we have a table or array and for some
purpose we want to reduce the number of levels of some factors by
summing subsets of the frequencies. For example, we may have initially
coded Age in 10-year intervals, and decide that, either for analysis or
display purposes, we want to reduce Age to 20-year intervals. The
<code>collapse.table()</code> function in <code>vcdExtra</code> was
designed for this purpose.</p>
<p><strong><em>Example</em></strong>: Create a 3-way table, and collapse
Age from 10-year to 20-year intervals. First, we generate a <span class="math inline">\(2 \times 6 \times 3\)</span> table of random
counts from a Poisson distribution with mean of 100.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># create some sample data in frequency form</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>sex <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;10-19&quot;</span>, <span class="st">&quot;20-29&quot;</span>,  <span class="st">&quot;30-39&quot;</span>, <span class="st">&quot;40-49&quot;</span>, <span class="st">&quot;50-59&quot;</span>, <span class="st">&quot;60-69&quot;</span>)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>education <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&#39;med&#39;</span>, <span class="st">&#39;high&#39;</span>)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">sex=</span>sex, <span class="at">age=</span>age, <span class="at">education=</span>education)</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">36</span>, <span class="dv">100</span>)   <span class="co"># random Possion cell frequencies</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data, counts)</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co"># make it into a 3-way table</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(counts <span class="sc">~</span> sex <span class="sc">+</span> age <span class="sc">+</span> education, <span class="at">data=</span>data)</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="fu">structable</span>(t1)</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="do">##                  age 10-19 20-29 30-39 40-49 50-59 60-69</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="do">## sex    education                                        </span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="do">## Male   low              98   105   104    90    90   101</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="do">##        med              97   105   101    88    97   107</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="do">##        high             99   101   109    88    99    96</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="do">## Female low             102   117   101   105    85    88</span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="do">##        med             106    84    92   116   110    96</span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="do">##        high            106    96   121    91   107   102</span></span></code></pre></div>
<p>Now collapse <code>age</code> to 20-year intervals, and
<code>education</code> to 2 levels. In the arguments, levels of
<code>age</code> and <code>education</code> given the same label are
summed in the resulting smaller table.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># collapse age to 3 levels, education to 2 levels</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">collapse.table</span>(t1, </span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>         <span class="at">age=</span><span class="fu">c</span>(<span class="st">&quot;10-29&quot;</span>, <span class="st">&quot;10-29&quot;</span>,  <span class="st">&quot;30-49&quot;</span>, <span class="st">&quot;30-49&quot;</span>, <span class="st">&quot;50-69&quot;</span>, <span class="st">&quot;50-69&quot;</span>),</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>         <span class="at">education=</span><span class="fu">c</span>(<span class="st">&quot;&lt;high&quot;</span>, <span class="st">&quot;&lt;high&quot;</span>, <span class="st">&quot;high&quot;</span>))</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="fu">structable</span>(t2)</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="do">##                  age 10-29 30-49 50-69</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a><span class="do">## sex    education                      </span></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="do">## Male   &lt;high           405   383   395</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a><span class="do">##        high            200   197   195</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a><span class="do">## Female &lt;high           409   414   379</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a><span class="do">##        high            202   212   209</span></span></code></pre></div>
</div>
<div id="collapsing-table-levels-dplyr" class="section level2">
<h2>Collapsing table levels: <code>dplyr</code></h2>
<p>For data sets in frequency form or case form, factor levels can be
collapsed by recoding the levels to some grouping. One handy function
for this is <code>dplyr::case_match()</code></p>
<p><strong><em>Example</em></strong>:</p>
<p>The <code>vcdExtra::Titanicp</code> data set contains information on
1309 passengers on the <em>RMS Titanic</em>, including
<code>sibsp</code>, the number of (0:8) siblings or spouses aboard, and
<code>parch</code> (0:6), the number of parents or children aboard, but
the table is quite sparse.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">table</span>(Titanicp<span class="sc">$</span>sibsp, Titanicp<span class="sc">$</span>parch)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="do">##    </span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="do">##       0   1   2   3   4   5   6   9</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="do">##   0 790  52  43   2   2   2   0   0</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="do">##   1 183  90  29   5   4   4   2   2</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="do">##   2  26   9   6   1   0   0   0   0</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="do">##   3   3   9   8   0   0   0   0   0</span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="do">##   4   0  10  12   0   0   0   0   0</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="do">##   5   0   0   6   0   0   0   0   0</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="do">##   8   0   0   9   0   0   0   0   0</span></span></code></pre></div>
<p>For purposes of analysis, we might want to collapse both of these to
the levels <code>0, 1, 2+</code>. Here’s how:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>Titanicp <span class="ot">&lt;-</span> Titanicp <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sibspF =</span> <span class="fu">case_match</span>(sibsp,</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>                            <span class="dv">0</span> <span class="sc">~</span> <span class="st">&quot;0&quot;</span>,</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>                            <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>                            <span class="dv">2</span><span class="sc">:</span><span class="fu">max</span>(sibsp) <span class="sc">~</span> <span class="st">&quot;2+&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sibspF =</span> <span class="fu">ordered</span>(sibspF)) <span class="sc">|&gt;</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parchF =</span> <span class="fu">case_match</span>(parch,</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>                             <span class="dv">0</span> <span class="sc">~</span> <span class="st">&quot;0&quot;</span>,</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>                             <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;1&quot;</span>,</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>                             <span class="dv">2</span><span class="sc">:</span><span class="fu">max</span>(parch) <span class="sc">~</span> <span class="st">&quot;2+&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parchF =</span> <span class="fu">ordered</span>(parchF)) </span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a><span class="fu">table</span>(Titanicp<span class="sc">$</span>sibspF, Titanicp<span class="sc">$</span>parchF)</span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="do">##     </span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a><span class="do">##        0   1  2+</span></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a><span class="do">##   0  790  52  49</span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="do">##   1  183  90  46</span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a><span class="do">##   2+  29  28  42</span></span></code></pre></div>
<p><code>car::recode()</code> is a similar function, but with a less
convenient interface.</p>
<p>The <a href="https://CRAN.R-project.org/package=forcats"><code>forcats</code></a>
package provides a collection of functions for reordering the levels of
a factor or grouping categories according to their frequency:</p>
<ul>
<li><code>forcats::fct_reorder()</code>: Reorder a factor by another
variable.</li>
<li><code>forcats::fct_infreq()</code>: Reorder a factor by the
frequency of values.</li>
<li><code>forcats::fct_relevel()</code>: Change the order of a factor by
hand.</li>
<li><code>forcats::fct_lump()</code>: Collapse the least/most frequent
values of a factor into “other”.</li>
<li><code>forcats::fct_collapse()</code>: Collapse factor levels into
manually defined groups.</li>
<li><code>forcats::fct_recode()</code>: Change factor levels by
hand.</li>
</ul>
</div>
<div id="converting-among-frequency-tables-and-data-frames" class="section level2">
<h2>Converting among frequency tables and data frames</h2>
<p>As we’ve seen, a given contingency table can be represented
equivalently in different forms, but some R functions were designed for
one particular representation.</p>
<p>The table below shows some handy tools for converting from one form
to another.</p>
<!-- [htb] -->
<!--  \caption{Tools for converting among different forms for categorical data} {#tab:convert} -->
<!--    {llll} -->
<!--    \hline -->
<!--                  & \multicolumn{3}{c}{**To this**} \\ -->
<!--    **From this**      &     Case form         & Frequency form             &  Table form \\ -->
<!--    \hline -->
<!--    Case form      &   noop                 & `xtabs(~A+B)`        &  `table(A,B)`  \\  -->
<!--    Frequency form &  `expand.dft(X)`  & noop                      & `xtabs(count~A+B)`\\ -->
<!--    Table form     &  `expand.dft(X)`  & `as.data.frame(X)`   &  noop \\ -->
<!--    \hline -->
<table>
<colgroup>
<col width="22%" />
<col width="26%" />
<col width="27%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><strong>From this</strong></th>
<th align="left"></th>
<th align="left"><strong>To this</strong></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left"><em>Case form</em></td>
<td align="left"><em>Frequency form</em></td>
<td><em>Table form</em></td>
</tr>
<tr class="even">
<td align="left"><em>Case form</em></td>
<td align="left">noop</td>
<td align="left"><code>xtabs(~A+B)</code></td>
<td><code>table(A,B)</code></td>
</tr>
<tr class="odd">
<td align="left"><em>Frequency form</em></td>
<td align="left"><code>expand.dft(X)</code></td>
<td align="left">noop</td>
<td><code>xtabs(count~A+B)</code></td>
</tr>
<tr class="even">
<td align="left"><em>Table form</em></td>
<td align="left"><code>expand.dft(X)</code></td>
<td align="left"><code>as.data.frame(X)</code></td>
<td>noop</td>
</tr>
</tbody>
</table>
<p>For example, a contingency table in table form (an object of
<code>class(table)</code>) can be converted to a data.frame with
<code>as.data.frame()</code>. <a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> The resulting <code>data.frame</code>
contains columns representing the classifying factors and the table
entries (as a column named by the <code>responseName</code> argument,
defaulting to <code>Freq</code>. This is the inverse of
<code>xtabs()</code>.</p>
<p><strong><em>Example</em></strong>: Convert the <code>GSStab</code> in
table form to a data.frame in frequency form.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">as.data.frame</span>(GSStab)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a><span class="do">##      sex party Freq</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a><span class="do">## 1 female   dem  279</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="do">## 2   male   dem  165</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a><span class="do">## 3 female indep   73</span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="do">## 4   male indep   47</span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a><span class="do">## 5 female   rep  225</span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a><span class="do">## 6   male   rep  191</span></span></code></pre></div>
<p><strong><em>Example</em></strong>: Convert the <code>Arthritis</code>
data in case form to a 3-way table of <code>Treatment</code> <span class="math inline">\(\times\)</span> <code>Sex</code> <span class="math inline">\(\times\)</span> <code>Improved</code>. Note the
use of <code>with()</code> to avoid having to use
<code>Arthritis\$Treatment</code> etc. within the call to
<code>table()</code>.% <a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>Art.tab <span class="ot">&lt;-</span> <span class="fu">with</span>(Arthritis, <span class="fu">table</span>(Treatment, Sex, Improved))</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="fu">str</span>(Art.tab)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="do">##  &#39;table&#39; int [1:2, 1:2, 1:3] 19 6 10 7 7 5 0 2 6 16 ...</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="do">##  - attr(*, &quot;dimnames&quot;)=List of 3</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="do">##   ..$ Treatment: chr [1:2] &quot;Placebo&quot; &quot;Treated&quot;</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="do">##   ..$ Sex      : chr [1:2] &quot;Female&quot; &quot;Male&quot;</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="do">##   ..$ Improved : chr [1:3] &quot;None&quot; &quot;Some&quot; &quot;Marked&quot;</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="fu">ftable</span>(Art.tab)</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a><span class="do">##                  Improved None Some Marked</span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a><span class="do">## Treatment Sex                             </span></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="do">## Placebo   Female            19    7      6</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a><span class="do">##           Male              10    0      1</span></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a><span class="do">## Treated   Female             6    5     16</span></span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a><span class="do">##           Male               7    2      5</span></span></code></pre></div>
<p>There may also be times that you will need an equivalent case form
<code>data.frame</code> with factors representing the table variables
rather than the frequency table. For example, the <code>mca()</code>
function in package <code>MASS</code> only operates on data in this
format. Marc Schwartz initially provided code for
<code>expand.dft()</code> on the Rhelp mailing list for converting a
table back into a case form <code>data.frame</code>. This function is
included in <code>vcdExtra</code>.</p>
<p><strong><em>Example</em></strong>: Convert the <code>Arthritis</code>
data in table form (<code>Art.tab</code>) back to a
<code>data.frame</code> in case form, with factors
<code>Treatment</code>, <code>Sex</code> and <code>Improved</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>Art.df <span class="ot">&lt;-</span> <span class="fu">expand.dft</span>(Art.tab)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="fu">str</span>(Art.df)</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="do">## &#39;data.frame&#39;:    84 obs. of  3 variables:</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="do">##  $ Treatment: chr  &quot;Placebo&quot; &quot;Placebo&quot; &quot;Placebo&quot; &quot;Placebo&quot; ...</span></span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a><span class="do">##  $ Sex      : chr  &quot;Female&quot; &quot;Female&quot; &quot;Female&quot; &quot;Female&quot; ...</span></span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a><span class="do">##  $ Improved : chr  &quot;None&quot; &quot;None&quot; &quot;None&quot; &quot;None&quot; ...</span></span></code></pre></div>
</div>
<div id="sec:complex" class="section level2">
<h2>A complex example</h2>
<p>If you’ve followed so far, you’re ready for a more complicated
example. The data file, <code>tv.dat</code> represents a 4-way table of
size <span class="math inline">\(5 \times 11 \times 5 \times 3\)</span>
where the table variables (unnamed in the file) are read as
<code>V1</code> – <code>V4</code>, and the cell frequency is read as
<code>V5</code>. The file, stored in the <code>doc/extdata</code>
directory of <code>vcdExtra</code>, can be read as follows:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>tv.data<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>,<span class="st">&quot;tv.dat&quot;</span>, <span class="at">package=</span><span class="st">&quot;vcdExtra&quot;</span>))</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="fu">head</span>(tv.data,<span class="dv">5</span>)</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="do">##   V1 V2 V3 V4 V5</span></span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="do">## 1  1  1  1  1  6</span></span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a><span class="do">## 2  2  1  1  1 18</span></span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a><span class="do">## 3  3  1  1  1  6</span></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="do">## 4  4  1  1  1  2</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="do">## 5  5  1  1  1 11</span></span></code></pre></div>
<p>For a local file, just use <code>read.table()</code> in this
form:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>tv.data<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">&quot;C:/R/data/tv.dat&quot;</span>)</span></code></pre></div>
<p>The data <code>tv.dat</code> came from the initial implementation of
mosaic displays in R by Jay Emerson. In turn, they came from the initial
development of mosaic displays <span class="citation">(Hartigan &amp;
Kleiner, 1984)</span> that illustrated the method with data on a large
sample of TV viewers whose behavior had been recorded for the Neilsen
ratings. This data set contains sample television audience data from
Neilsen Media Research for the week starting November 6, 1995.</p>
<p>The table variables are:</p>
<ul>
<li><code>V1</code>– values 1:5 correspond to the days
Monday–Friday;</li>
<li><code>V2</code>– values 1:11 correspond to the quarter hour times
8:00PM through 10:30PM;</li>
<li><code>V3</code>– values 1:5 correspond to ABC, CBS, NBC, Fox, and
non-network choices;</li>
<li><code>V4</code>– values 1:3 correspond to transition states: turn
the television Off, Switch channels, or Persist in viewing the current
channel.</li>
</ul>
<p>We are interested just the cell frequencies, and rely on the facts
that the</p>
<ol style="list-style-type: lower-alpha">
<li>the table is complete— there are no missing cells, so
<code>nrow(tv.data)</code> = 825;</li>
<li>the observations are ordered so that <code>V1</code> varies most
rapidly and <code>V4</code> most slowly. From this, we can just extract
the frequency column and reshape it into an array. [That would be
dangerous if any observations were out of order.]</li>
</ol>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>TV <span class="ot">&lt;-</span> <span class="fu">array</span>(tv.data[,<span class="dv">5</span>], <span class="at">dim=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">11</span>,<span class="dv">5</span>,<span class="dv">3</span>))                                        </span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="fu">dimnames</span>(TV) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;Monday&quot;</span>,<span class="st">&quot;Tuesday&quot;</span>,<span class="st">&quot;Wednesday&quot;</span>,<span class="st">&quot;Thursday&quot;</span>,<span class="st">&quot;Friday&quot;</span>), </span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">&quot;8:00&quot;</span>,<span class="st">&quot;8:15&quot;</span>,<span class="st">&quot;8:30&quot;</span>,<span class="st">&quot;8:45&quot;</span>,<span class="st">&quot;9:00&quot;</span>,<span class="st">&quot;9:15&quot;</span>,<span class="st">&quot;9:30&quot;</span>,         </span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>                       <span class="st">&quot;9:45&quot;</span>,<span class="st">&quot;10:00&quot;</span>,<span class="st">&quot;10:15&quot;</span>,<span class="st">&quot;10:30&quot;</span>),                            </span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">&quot;ABC&quot;</span>,<span class="st">&quot;CBS&quot;</span>,<span class="st">&quot;NBC&quot;</span>,<span class="st">&quot;Fox&quot;</span>,<span class="st">&quot;Other&quot;</span>), </span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">&quot;Off&quot;</span>,<span class="st">&quot;Switch&quot;</span>,<span class="st">&quot;Persist&quot;</span>))</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a><span class="fu">names</span>(<span class="fu">dimnames</span>(TV))<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Day&quot;</span>, <span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Network&quot;</span>, <span class="st">&quot;State&quot;</span>)</span></code></pre></div>
<p>More generally (even if there are missing cells), we can use
<code>xtabs()</code> (or <code>plyr::daply()</code>) to do the
cross-tabulation, using <code>V5</code> as the frequency variable.
Here’s how to do this same operation with <code>xtabs()</code>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>TV <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(V5 <span class="sc">~</span> ., <span class="at">data=</span>tv.data)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a><span class="fu">dimnames</span>(TV) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Day =</span> <span class="fu">c</span>(<span class="st">&quot;Monday&quot;</span>,<span class="st">&quot;Tuesday&quot;</span>,<span class="st">&quot;Wednesday&quot;</span>,<span class="st">&quot;Thursday&quot;</span>,<span class="st">&quot;Friday&quot;</span>), </span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>                     <span class="at">Time =</span> <span class="fu">c</span>(<span class="st">&quot;8:00&quot;</span>,<span class="st">&quot;8:15&quot;</span>,<span class="st">&quot;8:30&quot;</span>,<span class="st">&quot;8:45&quot;</span>,<span class="st">&quot;9:00&quot;</span>,<span class="st">&quot;9:15&quot;</span>,<span class="st">&quot;9:30&quot;</span>,         </span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>                              <span class="st">&quot;9:45&quot;</span>,<span class="st">&quot;10:00&quot;</span>,<span class="st">&quot;10:15&quot;</span>,<span class="st">&quot;10:30&quot;</span>),                            </span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>                     <span class="at">Network =</span> <span class="fu">c</span>(<span class="st">&quot;ABC&quot;</span>,<span class="st">&quot;CBS&quot;</span>,<span class="st">&quot;NBC&quot;</span>,<span class="st">&quot;Fox&quot;</span>,<span class="st">&quot;Other&quot;</span>), </span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>                     <span class="at">State =</span> <span class="fu">c</span>(<span class="st">&quot;Off&quot;</span>,<span class="st">&quot;Switch&quot;</span>,<span class="st">&quot;Persist&quot;</span>))</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a><span class="co"># table dimensions</span></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a><span class="fu">dim</span>(TV)</span></code></pre></div>
<p>But this 4-way table is too large and awkward to work with. Among the
networks, Fox and Other occur infrequently. We can also cut it down to a
3-way table by considering only viewers who persist with the current
station. <a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>TV2 <span class="ot">&lt;-</span> TV[,,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]      <span class="co"># keep only ABC, CBS, NBC</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>TV2 <span class="ot">&lt;-</span> TV2[,,,<span class="dv">3</span>]       <span class="co"># keep only Persist -- now a 3 way table</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="fu">structable</span>(TV2)</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="do">##                   Time 8:00 8:15 8:30 8:45 9:00 9:15 9:30 9:45 10:00 10:15 10:30</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a><span class="do">## Day       Network                                                               </span></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="do">## Monday    ABC           146  151  156   83  325  350  386  340   352   280   278</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a><span class="do">##           CBS           337  293  304  233  311  251  241  164   252   265   272</span></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="do">##           NBC           263  219  236  140  226  235  239  246   279   263   283</span></span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a><span class="do">## Tuesday   ABC           244  181  231  205  385  283  345  192   329   351   364</span></span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a><span class="do">##           CBS           173  180  184  109  218  235  256  250   274   263   261</span></span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a><span class="do">##           NBC           315  254  280  241  370  214  195  111   188   190   210</span></span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a><span class="do">## Wednesday ABC           233  161  194  156  339  264  279  140   237   228   203</span></span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a><span class="do">##           CBS           158  126  207   59   98  103  122   86   109   105   110</span></span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a><span class="do">##           NBC           134  146  166   66  194  230  264  143   274   289   306</span></span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a><span class="do">## Thursday  ABC           174  183  197  181  187  198  211   86   110   122   117</span></span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a><span class="do">##           CBS           196  185  195  104  106  116  116   47   102    84    84</span></span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a><span class="do">##           NBC           515  463  472  477  590  473  446  349   649   705   747</span></span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a><span class="do">## Friday    ABC           294  281  305  239  278  246  245  138   246   232   233</span></span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a><span class="do">##           CBS           130  144  154   81  129  153  136  126   138   136   152</span></span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a><span class="do">##           NBC           195  220  248  160  172  164  169   85   183   198   204</span></span></code></pre></div>
<p>Finally, for some purposes, we might want to collapse the 11 times
into a smaller number. Half-hour time slots make more sense. Here, we
use <code>as.data.frame.table()</code> to convert the table back to a
data frame, <code>levels()</code> to re-assign the values of
<code>Time</code>, and finally, <code>xtabs()</code> to give a new,
collapsed frequency table.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>TV.df <span class="ot">&lt;-</span> <span class="fu">as.data.frame.table</span>(TV2)</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="fu">levels</span>(TV.df<span class="sc">$</span>Time) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;8:00&quot;</span>, <span class="dv">2</span>),</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>                        <span class="fu">rep</span>(<span class="st">&quot;8:30&quot;</span>, <span class="dv">2</span>),</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>                        <span class="fu">rep</span>(<span class="st">&quot;9:00&quot;</span>, <span class="dv">2</span>), </span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>                        <span class="fu">rep</span>(<span class="st">&quot;9:30&quot;</span>, <span class="dv">2</span>), </span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a>                        <span class="fu">rep</span>(<span class="st">&quot;10:00&quot;</span>,<span class="dv">2</span>),</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>                            <span class="st">&quot;10:30&quot;</span></span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>                        )</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>TV3 <span class="ot">&lt;-</span> <span class="fu">xtabs</span>(Freq <span class="sc">~</span> Day <span class="sc">+</span> Time <span class="sc">+</span> Network, TV.df)</span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a><span class="fu">structable</span>(Day <span class="sc">~</span> Time<span class="sc">+</span>Network, TV3)</span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a><span class="do">##               Day Monday Tuesday Wednesday Thursday Friday</span></span>
<span id="cb35-14"><a href="#cb35-14" tabindex="-1"></a><span class="do">## Time  Network                                             </span></span>
<span id="cb35-15"><a href="#cb35-15" tabindex="-1"></a><span class="do">## 8:00  ABC            297     425       394      357    575</span></span>
<span id="cb35-16"><a href="#cb35-16" tabindex="-1"></a><span class="do">##       CBS            630     353       284      381    274</span></span>
<span id="cb35-17"><a href="#cb35-17" tabindex="-1"></a><span class="do">##       NBC            482     569       280      978    415</span></span>
<span id="cb35-18"><a href="#cb35-18" tabindex="-1"></a><span class="do">## 8:30  ABC            239     436       350      378    544</span></span>
<span id="cb35-19"><a href="#cb35-19" tabindex="-1"></a><span class="do">##       CBS            537     293       266      299    235</span></span>
<span id="cb35-20"><a href="#cb35-20" tabindex="-1"></a><span class="do">##       NBC            376     521       232      949    408</span></span>
<span id="cb35-21"><a href="#cb35-21" tabindex="-1"></a><span class="do">## 9:00  ABC            675     668       603      385    524</span></span>
<span id="cb35-22"><a href="#cb35-22" tabindex="-1"></a><span class="do">##       CBS            562     453       201      222    282</span></span>
<span id="cb35-23"><a href="#cb35-23" tabindex="-1"></a><span class="do">##       NBC            461     584       424     1063    336</span></span>
<span id="cb35-24"><a href="#cb35-24" tabindex="-1"></a><span class="do">## 9:30  ABC            726     537       419      297    383</span></span>
<span id="cb35-25"><a href="#cb35-25" tabindex="-1"></a><span class="do">##       CBS            405     506       208      163    262</span></span>
<span id="cb35-26"><a href="#cb35-26" tabindex="-1"></a><span class="do">##       NBC            485     306       407      795    254</span></span>
<span id="cb35-27"><a href="#cb35-27" tabindex="-1"></a><span class="do">## 10:00 ABC            632     680       465      232    478</span></span>
<span id="cb35-28"><a href="#cb35-28" tabindex="-1"></a><span class="do">##       CBS            517     537       214      186    274</span></span>
<span id="cb35-29"><a href="#cb35-29" tabindex="-1"></a><span class="do">##       NBC            542     378       563     1354    381</span></span>
<span id="cb35-30"><a href="#cb35-30" tabindex="-1"></a><span class="do">## 10:30 ABC            278     364       203      117    233</span></span>
<span id="cb35-31"><a href="#cb35-31" tabindex="-1"></a><span class="do">##       CBS            272     261       110       84    152</span></span>
<span id="cb35-32"><a href="#cb35-32" tabindex="-1"></a><span class="do">##       NBC            283     210       306      747    204</span></span></code></pre></div>
<p>We’ve come this far, so we might as well show a mosaic display. This
is analogous to that used by <span class="citation">Hartigan &amp;
Kleiner (1984)</span>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">mosaic</span>(TV3, <span class="at">shade =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>       <span class="at">labeling =</span> <span class="fu">labeling_border</span>(<span class="at">rot_labels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">90</span>)))</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>This mosaic displays can be read at several levels, corresponding to
the successive splits of the tiles and the residual shading. Several
trends are clear for viewers who persist:</p>
<ul>
<li>Overall, there are about the same number of viewers on each weekday,
with slightly more on Thursday.</li>
<li>Looking at time slots, viewership is slightly greater from 9:00 -
10:00 overall and also 8:00 - 9:00 on Thursday and Friday</li>
</ul>
<p>From the residual shading of the tiles:</p>
<ul>
<li>Monday: CBS dominates in all time slots.</li>
<li>Tuesday” ABC and CBS dominate after 9:00</li>
<li>Thursday: is a largely NBC day</li>
<li>Friday: ABC dominates in the early evening</li>
</ul>
<!-- ```{r, tv4} -->
<!-- TV.df <- as.data.frame.table(TV) -->
<!-- levels(TV.df$Time) <- c(rep("8:00-8:59",4), -->
<!--                         rep("9:00-9:59",4),  -->
<!--                         rep("10:00-10:44",3)) -->
<!-- TV3 <- xtabs(Freq ~ Day + Time + Network, TV.df) -->
<!-- structable(Day ~ Time+Network, TV3) -->
<!-- ``` -->
<!-- Whew! See \figref{fig:TV-mosaic} for a mosaic plot of the `TV3` data. -->
<!-- The table is too large to display conveniently, but we can show a subtable -->
<!-- by selecting the indices.  This call to `ftable()` subsets the first three -->
<!-- levels of each factor. -->
<!-- ```{r tv4} -->
<!-- ftable(TV[1:3,1:3,1:3,1:3], col.vars = 3:4) -->
<!-- ``` -->
<!-- We've come this far, so we might as well show a mosaic display. This is analogous to that used by -->
<!-- @vcd:Hartigan+Kleiner:1984. The result is too complex to see very much.  It would be useful to simplify -->
<!-- the table by collapsing one or more of the table dimensions, e.g., `Time`. -->
<!-- ```{r tv-mosaic2, fig.height=7, fig.width=7} -->
<!-- mosaic(TV[,,1:4,], shade=TRUE,  -->
<!--        labeling_args = list(abbreviate_labs = c(8,5,1,1))) -->
<!-- ``` -->
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-vcd:Agresti:2002" class="csl-entry">
Agresti, A. (2002). <em>Categorical data analysis</em> (2nd ed.).
Hoboken, New Jersey: John Wiley &amp; Sons.
</div>
<div id="ref-vcd:Hartigan+Kleiner:1984" class="csl-entry">
Hartigan, J. A., &amp; Kleiner, B. (1984). A mosaic of television
ratings. <em>The American Statistician</em>, <em>38</em>, 32–35.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>Changing <code>Admit</code> to <code>Admit?</code> might
be useful for display purposes, but is dangerous— because it is then
difficult to use that variable name in a model formula. See
@ref(sec:tips) for options <code>labeling_args</code> and
<code>set_labels</code>to change variable and level names for displays
in the <code>strucplot</code> framework.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Because R is object-oriented, this is actually a
short-hand for the function <code>as.data.frame.table()</code>.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p><code>table()</code> does not allow a <code>data</code>
argument to provide an environment in which the table variables are to
be found. In the examples in @ref(sec:table) I used
<code>attach(mydata)</code> for this purpose, but <code>attach()</code>
leaves the variables in the global environment, while
<code>with()</code> just evaluates the <code>table()</code> expression
in a temporary environment of the data.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>This relies on the fact that that indexing an array
drops dimensions of length 1 by default, using the argument
<code>drop=TRUE</code>; the result is coerced to the lowest possible
dimension.<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
